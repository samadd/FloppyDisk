(function(f){function k(a){a=r.call(a);return"[object Object]"===a||"[object Array]"===a}function t(a,b){if(b&&-1===u.indexOf(b))throw Error("Unsupported type. Not saved. Condemned.");this.type=b||typeof a;this.value=a}function g(a){for(var b in a)l(b,a[b],void 0);return e}function l(a,b,m){c.setItem(a,v(new t(b,m)));return e}function n(a){c.removeItem(a);return e}function v(a){return JSON.stringify(a)}function p(a){var b;try{b="string"===typeof a?JSON.parse(a):w}catch(m){console.error("Failed to parse text '"+
a+"' as JSON. Probably an existing string in local storage. Returning plain text value."),b={type:"string",value:a}}a=b;switch(a.type){case "number":a=parseFloat(a.value);break;case "date":a=new Date(a.value);break;case "string":case "object":case "boolean":case "undefined":a=a.value;break}return a}function h(a){for(var b in a)k(a[b])&&(a[b]=h(a[b]));return new Proxy(a,{set:function(a,b,c){k(c)&&(c=h(c));a[b]=c;g(d);return!0},deleteProperty:function(a,b){delete a[b];n(b);g(d);return!0}})}var c=f.localStorage,
u=["string","number","object","date","boolean"],r={}.toString,w={type:"undefined",value:void 0},d,e;e={saveFiles:g,saveFile:l,loadFiles:function(){for(var a={},b=0,e=c.length;b<e;b++){var d=c.key(b);a[d]=p(c.getItem(d||""))}return a},loadFile:function(a){a=c.getItem(a);return p(a)},deleteFile:n,format:function(){d=void 0;c.clear();return e},autoSave:function(a){if(d)throw Error("Autosave already initiated. Specify one root object only.");d=a;g(a);return h(a)},eject:function(){d=void 0;return f.FloppyDisk=
q}};var q={insert:function(){return f.FloppyDisk=e}};f.FloppyDisk=q})(window);